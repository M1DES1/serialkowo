// Dane serialu
const hazbinHotelData = {
    seasons: {
        1: [
            {
                number: 0,
                title: "Pilot",
                description: "Odcinek pilotażowy",
                duration: "32:00",
                videoUrl: "https://github.com/M1DES1/serialkowo/raw/refs/heads/main/seriale/hazbinhotel/HAZBIN%20HOTEL%20(PILOT)%20%20Dubbing%20PL%20-%20BruDolina%20Studios%20(1080p,%20h264).mp4",
                language: "Dubbing PL"
            },
            {
                number: 1,
                title: "Uwertura",
                description: "Odcinek 1",
                duration: "24:00",
                videoUrl: "https://box-1192-e.vmwesa.online/hls/,xqx2onijybokjiqbtehs5lywurs7vpdsulxqknsludjyzzjm7q7536jhcuca,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 2,
                title: "Radio zabiło gwiazdę",
                description: "Odcinek 2",
                duration: "22:00",
                videoUrl: "https://fs50.bigwarp.io/v/02/00483/6f85lhv3z1wu_x/x.mp4?t=5lD-05Ug5xlYFAQjTTRiEqgrhN9VsCPPYKD6k5I-634&s=1762965365&e=43200&f=2417121&sp=1000&i=0.0&kmnr=689547918047",
                language: "Lektor PL"
            },
            {
                number: 3,
                title: "Jajecznica",
                description: "Odcinek 3",
                duration: "25:00",
                videoUrl: "https://box-1245-w.vmwesa.online/hls/,xqx2pgajybokjiqbtehs5k2dwb2kywujxno7rbkd5t4yrt4rkl7mz2sxmp7q,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 4,
                title: "Maskarada",
                description: "Odcinek 4",
                duration: "23:00",
                videoUrl: "https://fs51.bigwarp.io/v/01/00483/5xne159tmk1d_x/x.mp4?t=azDRmn5rO4HGD-YwJe93d4tOiTEfib8-4Mo1b6who3o&s=1762965505&e=43200&f=2417243&sp=1000&i=0.0&kmnr=435052582522",
                language: "Lektor PL"
            },
            {
                number: 5,
                title: "Pojedynek o ojcostwo",
                description: "Odcinek 5",
                duration: "26:00",
                videoUrl: "https://box-1163-t.vmwesa.online/hls/,xqx2pyyjybokjiqbtehs5kqrx3uzxpjntor2xbnkndxgisqdpgn7hrioavaa,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 6,
                title: "Witamy w niebie",
                description: "Odcinek 6",
                duration: "24:00",
                videoUrl: "https://box-1183-rp.vmwesa.online/hls/,xqx2pxczybokjiqbtees5maoxtla56xqch65lig2hiktztsw7k4jt6mzwnda,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 7,
                title: "Hejka, Rosie!",
                description: "Odcinek 7",
                duration: "25:00",
                videoUrl: "https://box-1181-pd.vmwesa.online/hls/,xqx2olqkybokjiqbtehs5pybxt4n5syawmvvyx4un57mapwyfasl2mcqnwza,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 8,
                title: "Przedstawienie musi trwać",
                description: "Odcinek 8",
                duration: "27:00",
                videoUrl: "https://fs69.bigwarp.io/v/01/02250/y4xep40vzit1_x/x.mp4?t=sYm5CeAcUn19DNlH0TUFy_r-rVWCRl5jQG8lf9goyQo&s=1762967723&e=43200&f=11252472&sp=1000&i=0.0&kmnr=513936365447",
                language: "Napisy PL"
            }
        ],
        2: [
            {
                number: 1,
                title: "Nowy Pentious",
                description: "Odcinek 1",
                duration: "24:00",
                videoUrl: "https://box-1183-rp.vmwesa.online/hls/,xqx2pikzybokjiqbtees56a44phsyhd36kz4ofnia4daenlqilksd62dmxxq,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 2,
                title: "Gawędziarz",
                description: "Odcinek 2",
                duration: "23:00",
                videoUrl: "https://box-1246-e.vmwesa.online/hls/,xqx2pjszybokjiqbtees5ja3xyih73wqebmen3p4xdsrjmxbdjrspanqrlqa,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 3,
                title: "Hazbin Hotel za zamkniętymi drzwiami",
                description: "Odcinek 3",
                duration: "25:00",
                videoUrl: "https://str39.vidoza.net/vod/v2/nvl4cbeejifeieno3widxh5mn2se7ka5sj2plj6pugmjpczauwbrb24uoeypu2hey4/v.mp4",
                language: "Lektor PL"
            },
            {
                number: 4,
                title: "Umowa stoi",
                description: "Odcinek 4",
                duration: "26:00",
                videoUrl: "https://box-1396-t10.vmeas.cloud/hls/,xqx2oljmyjokjiqbtevs5o2nuiocr6wygrdmplwah5axac5h27vbdngwclkq,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 5,
                title: "Uciszeni",
                description: "Odcinek 5",
                duration: "24:00",
                videoUrl: "https://vef-doc-2ccd.transitto.online/hls/,xqx2objm7vokjiqbte2c5lce4c2gleeaebxl4utw4lbxlaitpp36xwjp4iaa,.urlset/master.m3u8",
                language: "Lektor PL"
            },
            {
                number: 6,
                title: "Wrzeszcz",
                description: "Odcinek 6",
                duration: "25:00",
                videoUrl: "https://fs37.bigwarp.io/v/01/02295/bwebgls0ul1r_x/x.mp4?t=lY2LNbq664PQOWnpYuKJur8aHwO_p-TBGrjfENsMUL8&s=1762966881&e=43200&f=11477415&sp=1000&i=0.0&kmnr=373982843175",
                language: "Lektor PL"
            }
        ]
    }
};

// Inicjalizacja
document.addEventListener('DOMContentLoaded', function() {
    console.log('Strona załadowana');
    initEventListeners();
    
    // Inicjalizacja strony z odcinkami
    if (window.location.pathname.includes('hazbin-hotel.html') || window.location.pathname.endsWith('/')) {
        initEpisodesPage();
    }
});

// Inicjalizacja strony z odcinkami
function initEpisodesPage() {
    const seasonButtons = document.querySelectorAll('.season-btn');
    const episodesList = document.getElementById('episodes-list');
    const seasonTitle = document.getElementById('season-title');
    
    if (!episodesList) return; // Jeśli nie ma listy odcinków, wyjdź
    
    console.log('Inicjalizacja strony z odcinkami');
    
    // Ładuj domyślnie sezon 1
    loadSeason(1, episodesList, seasonTitle);
    
    // Obsługa zmiany sezonu
    seasonButtons.forEach(btn => {
        btn.addEventListener('click', function() {
            const season = parseInt(this.getAttribute('data-season'));
            console.log('Kliknięto sezon:', season);
            
            // Aktualizuj aktywne przyciski
            seasonButtons.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Załaduj odcinki dla wybranego sezonu
            loadSeason(season, episodesList, seasonTitle);
        });
    });
}

// Ładowanie odcinków dla sezonu
function loadSeason(seasonNumber, episodesList, seasonTitle) {
    const episodes = hazbinHotelData.seasons[seasonNumber];
    
    if (!episodes) {
        episodesList.innerHTML = '<p>Brak odcinków dla tego sezonu.</p>';
        return;
    }
    
    seasonTitle.textContent = `Sezon ${seasonNumber} - Odcinki:`;
    episodesList.innerHTML = '';
    
    episodes.forEach(episode => {
        const episodeCard = document.createElement('div');
        episodeCard.className = 'episode-card';
        episodeCard.setAttribute('data-episode', episode.number);
        episodeCard.setAttribute('data-season', seasonNumber);
        
        episodeCard.innerHTML = `
            <div class="episode-number">${episode.number.toString().padStart(2, '0')}</div>
            <div class="episode-info">
                <h3>${episode.title}</h3>
                <p>${episode.description} • ${episode.duration} • <span class="language-badge ${episode.language === 'Dubbing PL' ? 'dubbing' : episode.language === 'Napisy PL' ? 'subtitles' : 'lector'}">${episode.language}</span></p>
            </div>
        `;
        
        episodeCard.addEventListener('click', function() {
            const episodeNumber = parseInt(this.getAttribute('data-episode'));
            const seasonNumber = parseInt(this.getAttribute('data-season'));
            console.log('Kliknięto odcinek:', episodeNumber, 'Sezon:', seasonNumber);
            playEpisode(episodeNumber, seasonNumber);
        });
        
        episodesList.appendChild(episodeCard);
    });
    
    console.log(`Załadowano ${episodes.length} odcinków sezonu ${seasonNumber}`);
}

// Inicjalizacja nasłuchiwaczy zdarzeń
function initEventListeners() {
    // Przejście do odcinków po kliknięciu okładki
    const hazbinCover = document.getElementById('hazbin-cover');
    if (hazbinCover) {
        console.log('Znaleziono okładkę Hazbin Hotel');
        hazbinCover.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('Kliknięto okładkę Hazbin Hotel');
            window.location.href = 'hazbin-hotel.html';
        });
    }

    // Obsługa klawiszy klawiatury
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            // Powrót do poprzedniej strony
            if (document.referrer) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }
    });
}

// Odtwarzanie odcinka
function playEpisode(episodeNumber, seasonNumber = 1) {
    console.log('Próba odtworzenia odcinka:', episodeNumber, 'Sezon:', seasonNumber);
    
    const episodes = hazbinHotelData.seasons[seasonNumber];
    const episode = episodes.find(ep => ep.number === episodeNumber);
    
    if (episode) {
        console.log('Znaleziono odcinek:', episode);
        
        // Przekierowanie do odtwarzacza z numerem odcinka i sezonu
        window.location.href = `player.html?episode=${episodeNumber}&season=${seasonNumber}`;
        
    } else {
        console.error('Nie znaleziono odcinka:', episodeNumber);
        alert('Nie znaleziono odcinka!');
    }
}

console.log('Serialkowo zainicjalizowane');
